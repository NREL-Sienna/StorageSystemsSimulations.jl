<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>StorageDispatchWithReserves · StorageSystemsSimulations.jl</title><meta name="title" content="StorageDispatchWithReserves · StorageSystemsSimulations.jl"/><meta property="og:title" content="StorageDispatchWithReserves · StorageSystemsSimulations.jl"/><meta property="twitter:title" content="StorageDispatchWithReserves · StorageSystemsSimulations.jl"/><meta name="description" content="Documentation for StorageSystemsSimulations.jl."/><meta property="og:description" content="Documentation for StorageSystemsSimulations.jl."/><meta property="twitter:description" content="Documentation for StorageSystemsSimulations.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="StorageSystemsSimulations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">StorageSystemsSimulations.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome Page</a></li><li><a class="tocitem" href="../../quick_start_guide/">Quick Start Guide</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/single_stage_model/">Solving an operation with StorageSystemSimulations</a></li><li><a class="tocitem" href="../../tutorials/simulation_tutorial/">Simulating operations with StorageSystemSimulations</a></li></ul></li><li><span class="tocitem">Formulation Library</span><ul><li class="is-active"><a class="tocitem" href>StorageDispatchWithReserves</a><ul class="internal"><li><a class="tocitem" href="#Attributes"><span>Attributes</span></a></li><li><a class="tocitem" href="#Mathematical-Model"><span>Mathematical Model</span></a></li></ul></li></ul></li><li><span class="tocitem">Code Base Developer Guide</span><ul><li><a class="tocitem" href="../../code_base_developer_guide/developer/">Guidelines for Developers</a></li><li><a class="tocitem" href="../../code_base_developer_guide/internals/">Internals</a></li></ul></li><li><a class="tocitem" href="../../api/StorageSystemsSimulations/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Formulation Library</a></li><li class="is-active"><a href>StorageDispatchWithReserves</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>StorageDispatchWithReserves</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NREL-Sienna/StorageSystemsSimulations.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NREL-Sienna/StorageSystemsSimulations.jl/blob/main/docs/src/formulation_library/StorageDispatchWithReserves.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="StorageDispatchWithReserves-Formulation"><a class="docs-heading-anchor" href="#StorageDispatchWithReserves-Formulation"><code>StorageDispatchWithReserves</code> Formulation</a><a id="StorageDispatchWithReserves-Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#StorageDispatchWithReserves-Formulation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StorageSystemsSimulations.StorageDispatchWithReserves" href="#StorageSystemsSimulations.StorageDispatchWithReserves"><code>StorageSystemsSimulations.StorageDispatchWithReserves</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Formulation type to add storage formulation than can provide ancillary services. If a storage unit does not contribute to any service, then the variables and constraints related to services are ignored.</p><p>The formulation supports the following attributes. See Documentation for more details.</p><pre><code class="language-julia hljs">DeviceModel(
    StorageType, # E.g. EnergyReservoirStorage or GenericStorage
    StorageDispatchWithReserves;
    attributes=Dict(
        &quot;reservation&quot; =&gt; true,
        &quot;cycling_limits&quot; =&gt; false,
        &quot;energy_target&quot; =&gt; false,
        &quot;complete_coverage&quot; =&gt; false,
        &quot;regularization&quot; =&gt; true,
    ),
    use_slacks=false,
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NREL-Sienna/StorageSystemsSimulations.jl/blob/3152788ca1d8c7a31b42e04c5f6f3369622dd7a6/src/core/formulations.jl#L4">source</a></section></article><h2 id="Attributes"><a class="docs-heading-anchor" href="#Attributes">Attributes</a><a id="Attributes-1"></a><a class="docs-heading-anchor-permalink" href="#Attributes" title="Permalink"></a></h2><ul><li><code>&quot;reservation&quot;</code>: Forces the storage to operate exclusively on charge or discharge mode through the entire operation interval. We recommend setting this to false for models with relatively longer time resolutions (e.g., 1-Hr) since the storage can take simultaneous charge or discharge positions on average over the period.</li><li><code>&quot;cycling_limits&quot;</code>: This limits the storage&#39;s energy cycling. A single charging (discharging) cycle is fully charging (discharging) the storage once. The calculation uses the total energy charge/discharge and the number of cycles. Currently, the formulation only supports a fixed value per operation period. Additional variables for <a href="../../api/StorageSystemsSimulations/#StorageSystemsSimulations.StorageChargeCyclingSlackVariable"><code>StorageChargeCyclingSlackVariable</code></a> and <a href="../../api/StorageSystemsSimulations/#StorageSystemsSimulations.StorageDischargeCyclingSlackVariable"><code>StorageDischargeCyclingSlackVariable</code></a> are included in the model if <code>use_slacks</code> is set to <code>true</code>.</li><li><code>&quot;energy_target&quot;</code>: Set a target at the end of the model horizon for the storage&#39;s state of charge. Currently, the formulation only supports a fixed value per operation period. Additional variables for <a href="../../api/StorageSystemsSimulations/#StorageSystemsSimulations.StorageEnergyShortageVariable"><code>StorageEnergyShortageVariable</code></a> and <a href="../../api/StorageSystemsSimulations/#StorageSystemsSimulations.StorageEnergySurplusVariable"><code>StorageEnergySurplusVariable</code></a> are included in the model if <code>use_slacks</code> is set to <code>true</code>.</li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Combining cycle limits and energy target attributes is not recommended. Both attributes impose constraints on energy. There is no guarantee that the constraints can be satisfied simultaneously.</p></div></div><ul><li><code>&quot;complete_coverage&quot;</code>: This attribute implements constraints that require the battery to cover the sum of all the ancillary services it participates in simultaneously. It is equivalent to holding energy in case all the services get deployed simultaneously. This constraint is added to the constraints that cover each service independently and corresponds to a more conservative operation regime.</li><li><code>&quot;regularization&quot;</code>: This attribute smooths the charge/discharge profiles to avoid bang-bang solutions via a penalty on the absolute value of the intra-temporal variations of the charge and discharge power. Solving for optimal storage dispatch can stall in models with large amounts of curtailment or long periods with negative or zero prices due to numerical degeneracy. The regularization term is scaled by the storage device&#39;s power limits to normalize the term and avoid additional penalties to larger storage units.</li></ul><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>Setting the energy target attribute in combination with <a href="../../api/StorageSystemsSimulations/#StorageSystemsSimulations.EnergyTargetFeedforward"><code>EnergyTargetFeedforward</code></a> or <a href="../../api/StorageSystemsSimulations/#StorageSystemsSimulations.EnergyLimitFeedforward"><code>EnergyLimitFeedforward</code></a> is not permitted and StorageSystemsSimulations will throw an exception.</p></div></div><h2 id="Mathematical-Model"><a class="docs-heading-anchor" href="#Mathematical-Model">Mathematical Model</a><a id="Mathematical-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Model" title="Permalink"></a></h2><h3 id="Sets"><a class="docs-heading-anchor" href="#Sets">Sets</a><a id="Sets-1"></a><a class="docs-heading-anchor-permalink" href="#Sets" title="Permalink"></a></h3><p class="math-container">\[\begin{align*}
    &amp;\mathcal{P}^{\text{as}_\text{up}} &amp; \text{Up Ancillary Service Products Set}\\
    &amp;\mathcal{P}^{\text{as}_\text{dn}} &amp; \text{Down Ancillary Service Products Set}\\
    &amp;\mathcal{P}^{\text{as}} := \bigcup\left\{ \mathcal{P}^{\text{as}_\text{up}}, \mathcal{P}^{\text{as}_\text{dn}}\right\} &amp; \text{Ancillary Service Products Set}\\
    &amp;\mathcal{T} := \{1,\dots,T\} &amp; \text{Time steps} \\
\end{align*}\]</p><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><h4 id="Operational-Parameters"><a class="docs-heading-anchor" href="#Operational-Parameters">Operational Parameters</a><a id="Operational-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Operational-Parameters" title="Permalink"></a></h4><p class="math-container">\[\begin{align*}
    &amp;P^{max,ch}_{st} &amp;\text{Max Charge Power Storage [MW]}\\
    &amp;P^{max,ds}_{st} &amp;\text{Max Discharge Power Storage [MW]}\\
    &amp;\eta^{ch}_{st} &amp;\text{Charge Efficiency Storage [\%/hr]}\\
    &amp;\eta^{ds}_{st} &amp;\text{Discharge Efficiency Storage [\%/hr]}\\
    &amp;R^{*}_{p, t} &amp;\text{Ancillary Service deployment Forecast at time $t$ for service $p \in \mathcal{P}^{\text{as}}$ [\$/MW]}\\
    &amp;E^{max}_{st} &amp;\text{Max Energy Storage Capacity [MWh]}\\
    &amp;E^{st}_{0} &amp;\text{Storage initial energy [MWh]}\\
    &amp;E^{st}_{T} &amp;\text{Storage Energy Target at the end of the horizon, i.e., time-step $T$ [MWh]}\\
    &amp;\Delta t  &amp;\text{Timestep length}\\
    &amp;C_{st} &amp; \text{Maximum number of cycles over the horizon.} \\
    &amp;&amp; \text{For DA the value is fixed to 3 and in RT the value depends on the DA allocation of cycles} \\
    &amp;N_{p} &amp; \text{Number of periods of compliance to supply an AS.}\\
    &amp;&amp; \text{For example Spinning reserve has 12 for 1 hour of compliance when $\Delta_t$ is 5-minutes.}
\end{align*}\]</p><h4 id="Cost-Parameters"><a class="docs-heading-anchor" href="#Cost-Parameters">Cost Parameters</a><a id="Cost-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Cost-Parameters" title="Permalink"></a></h4><p class="math-container">\[\begin{align*}
    &amp;\text{VOM} &amp;\text{Storage Variable Operation and Maintenance Cost [\%/MWh]}\\
    &amp;\rho^{e+} &amp;\text{Storage Surplus penalty at end of target cost [\$/MWh]. Used when \texttt{use\_slacks = true}}\\
    &amp;\rho^{e-} &amp;\text{Storage Shortage penalty at end of target cost [\$/MWh]. Used when \texttt{use\_slacks = true}}\\
    &amp;\rho^{c} &amp;\text{Storage Cycling Penalty [\$/MWh]. Used when \texttt{use\_slacks = true}}\\
    &amp;\rho^{z} &amp;\text{Regularization Terms Penalty. Used when \texttt{&quot;regularization&quot; =&gt; true}}\\
\end{align*}\]</p><h3 id="Variables"><a class="docs-heading-anchor" href="#Variables">Variables</a><a id="Variables-1"></a><a class="docs-heading-anchor-permalink" href="#Variables" title="Permalink"></a></h3><p class="math-container">\[\begin{align*}
    &amp;p^{st, ch}_{t}  &amp; \in [0, P^{max,ch}_{st}] &amp;\quad\text{Expected Storage charging power}\\
    &amp;p^{st, ds}_{t}  &amp; \in [0, P^{max,ds}_{st}] &amp;\quad\text{Expected Storage discharging power}\\
    &amp;e^{st}_{t}  &amp; \in [0, E^{max}_{st}] &amp;\quad \text{Expected Storage Energy}\\
    &amp;\text{ss}^{st}_{t}  &amp; \in \{ 0, 1 \} &amp;\quad \text{Charge/Discharge status Storage. Used when \texttt{&quot;reservation&quot; =&gt; true}}\\
    &amp;sb_{stc,p,t} &amp; \in [0, P^{max,ch}_{st}] &amp; \quad \text{Ancillary service fraction assigned to Storage Charging}\\
    &amp;sb_{std,p,t} &amp; \in [0, P^{max,ds}_{st}] &amp; \quad \text{Ancillary service fraction assigned to Storage Discharging}\\
    &amp;e^{st+}  &amp; \in [0, E^{max}_{st}] &amp;\quad \text{Storage Energy Surplus above target. Used when \texttt{use\_slacks = true}}\\
    &amp;e^{st-}  &amp; \in [0, E^{max}_{st}] &amp;\quad \text{Storage Energy Shortage below target. Used when \texttt{use\_slacks = true}}\\
    &amp;c^{ch-}  &amp; \in [0, T C_{st}] &amp;\quad \text{Charging Cycling Shortage. Used when \texttt{use\_slacks = true}}\\
    &amp;c^{ds-}  &amp; \in [0, T C_{st}] &amp;\quad \text{Discharging Cycling Shortage. Used when \texttt{use\_slacks = true}}\\
    &amp;z^{st, ch}_{t} &amp; \in [0, P^{max,ch}_{st}] &amp;\quad \text{Regularization charge variable. Used when \texttt{&quot;regularization&quot; =&gt; true}}\\
    &amp;z^{st, ds}_{t} &amp; \in [0, P^{max,ds}_{st}] &amp;\quad \text{Regularization discharge variable. Used when \texttt{&quot;regularization&quot; =&gt; true}}\\
\end{align*}\]</p><h3 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h3><p class="math-container">\[\begin{aligned}
\min_{\substack{\boldsymbol{p}^{st, ch}, \boldsymbol{p}^{st, ds}, \boldsymbol{e}^{st}, \\ e^{st+}, e^{st-}, c^{ch-} + c^{ds-}}}
&amp; \rho^{e+} e^{st+} + \rho^{e-} e^{st-} + \rho^{c} \left(c^{ch-} + c^{ds-} \right) + \rho^{z} \left(\frac{z^{ch}}{P^{max,ch}_{st}} + \frac{z^{ds}}{P^{max,ds}_{st}} \right)\\
&amp; +\Delta t \sum_{t \in \mathcal{T}} \text{VOM}_{st} \left ( \left(\sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t} sb_{stc,p,t} + p^{st,ch}_{t} \right) + \left(\sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t} sb_{std,p,t} + p^{st,ds}_{t}\right) \right) &amp;
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
\text{s.t.}  &amp; &amp;\\
&amp;\text{Power Limit Constraints.}&amp;\\
&amp;p^{st, ch}_{t} + \sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} sb_{stc,p,t} \leq (1 - \text{ss}^{st}_{t})P^{max,ch}_{st} &amp; \quad \forall t \in \mathcal{T} \\
&amp; p^{st, ch}_{t} - \sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} sb_{stc,p,t} \geq 0 &amp; \quad \forall t \in \mathcal{T}\\
&amp; p^{st, ds}_{t} + \sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} sb_{std,p,t} \leq \text{ss}^{st}_{t}P^{max,ds}_{st} &amp; \forall t \in \mathcal{T}\\
&amp; p^{st, ds}_{t} - \sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} sb_{std,p,t} \geq 0 &amp; \forall t \in \mathcal{T}\\
&amp;\text{Energy Storage Limit Constraints}&amp;\\
&amp;e^{st}_{t} \leq E^{max}_{st} &amp; \forall t \in \mathcal{T}\\
&amp; e^{st}_{t} \geq E^{min}_{st} &amp; \forall t \in \mathcal{T}\\
&amp;\text{Energy Bookkeeping constraints}&amp;\\
&amp; E^{st}_{0} + \Delta t  \left(\sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,1} sb_{stc,p,1} + p^{st,ch}_{1}  - \sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,1} sb_{stc,p,1}\right)\eta^{ch}_{st}&amp;\\
&amp;-\Delta t\left(\sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,1} sb_{std,p,1} + p^{st,ds}_{1} - \sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t} sb_{std,p,1}\right)\frac{1}{\eta^{ds}_{st}}=e^{st}_{1}\\
&amp;e^{st}_{t-1} + \Delta t  \left(\sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t} sb_{stc,p,t} + p^{st,ch}_{t}  - \sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t} sb_{stc,p,t}\right)\eta^{ch}_{st}&amp;\\
&amp;-\Delta t\left(\sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t} sb_{std,p,t} + p^{st,ds}_{t} - \sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t} sb_{std,p,t}\right)\frac{1}{\eta^{ds}_{st}} =e^{st}_{t} &amp; \forall t \in \mathcal{T} \setminus {1}\\
&amp;\text{End of period energy target constraint. Used when \texttt{&quot;energy\_target&quot; =&gt; true}}&amp;\\
&amp;e^{st}_{T} + e^{st+} - e^{st-} = E^{st}_{T}&amp;\\
&amp;\text{Storage Cycling Limits Constraints. Used when \texttt{&quot;cycling\_limits&quot; =&gt; true}}&amp;\\
&amp; \sum_{t \in \mathcal{T}} \left(\sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t} sb_{std,p,t} + p^{st,ds}_{t}\right)\frac{1}{\eta^{ds}_{st}} \Delta t - c^{ds-} \leq C_{st} E^{max}_{st} &amp;\\
&amp; \sum_{t \in \mathcal{T}} \left(\sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t} sb_{stc,p,t} + p^{st,ch}_{t} \right)\eta^{ch}_{st} \Delta t - c^{ch-} \leq C_{st} E^{max}_{st} \\
&amp;\text{Single Ancillary Services Energy Coverage}&amp;\\
&amp; sb_{stc,p,t}  \eta^{ch}_{st} N_{p} \Delta t \le E_{st}^{max} - e^{st}_{t} &amp; \forall p \in \mathcal{P}^{as_{dn}} \ \forall t \in \mathcal{T}\\
&amp; sb_{std,p,t}  \frac{1}{\eta^{ds}_{st}} N_{p} \Delta t \leq e^{st}_{t}- E^{min}_{st} &amp; \forall p \in \mathcal{P}^{as_{up}}, \ \forall t \in \mathcal{T}\\
&amp; sb_{stc,p,1}  \eta^{ch}_{st} N_{p} \Delta t \le E_{st}^{max} - e^{st}_0 &amp; \forall p \in \mathcal{P}^{as_{dn}}\\
&amp; sb_{stc,p,t}  \eta^{ch}_{st} N_{p} \Delta t \le E_{st}^{max} - e^{st}_{t-1} &amp; \forall p \in \mathcal{P}^{as_{dn}} \ \forall t \in \mathcal{T} \setminus 1\\
&amp;sb_{std,p,1}  \frac{1}{\eta^{ds}_{st}} N_{p} \Delta t \leq e^{st}_0 - E^{min}_{st} &amp; \forall p \in \mathcal{P}^{as_{up}}\\
&amp; sb_{std,p,t}  \frac{1}{\eta^{ds}_{st}} N_{p} \Delta t \leq e^{st}_{t-1} - E^{min}_{st} &amp; \forall p \in \mathcal{P}^{as_{up}}, \ \forall t \in \mathcal{T} \setminus 1 \\
&amp;\text{Complete Ancillary Services Energy Coverage. Used when \texttt{&quot;complete\_coverage&quot; =&gt; true}}&amp;\\
&amp; \sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}}  sb_{stc,p,t}  \eta^{ch}_{st} N_{p} \Delta t \le E_{st}^{max} - e^{st}_{t} &amp; \forall t \in \mathcal{T}\\
&amp; \sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} sb_{std,p,t}  \frac{1}{\eta^{ds}_{st}} N_{p} \Delta t \leq e^{st}_{t}- E^{min}_{st} &amp; \forall t \in \mathcal{T}\\
&amp; \sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} sb_{stc,p,1}  \eta^{ch}_{st} N_{p} \Delta t \le E_{st}^{max} - e^{st}_0 &amp;\\
&amp;\sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}}  sb_{stc,p,t} \eta^{ch}_{st} N_{p} \Delta t \le E_{st}^{max} - e^{st}_{t-1} &amp; \forall t \in \mathcal{T} \setminus 1\\
&amp;\sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} sb_{std,p,1}  \frac{1}{\eta^{ds}_{st}} N_{p} \Delta t \leq e^{st}_0- E^{min}_{st} &amp; \\
&amp; \sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} sb_{std,p,t}  \frac{1}{\eta^{ds}_{st}} N_{p} \Delta t \leq e^{st}_{t-1}- E^{min}_{st} &amp; \forall t \in \mathcal{T} \setminus 1\\
&amp;\text{Regularization Constraints. Used when \texttt{&quot;regularization&quot; =&gt; true}}&amp;\\
&amp; \left(\sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t-1} sb_{stc,p,t-1} + p^{st,ch}_{t-1}  - \sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t-1} sb_{stc,p,t-1}\right) &amp;\\
&amp; - \left(\sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t} sb_{stc,p,t} + p^{st,ch}_{t}  - \sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t} sb_{stc,p,t}\right) \le z^{st, ch}_{t} &amp; \forall t \in \mathcal{T} \setminus 1\\
&amp; \left(\sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t-1} sb_{stc,p,t-1} + p^{st,ch}_{t-1}  - \sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t-1} sb_{stc,p,t-1}\right) &amp;\\
&amp; - \left(\sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t} sb_{stc,p,t} + p^{st,ch}_{t}  - \sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t} sb_{stc,p,t}\right) \ge -z^{st, ch}_{t} &amp; \forall t \in \mathcal{T} \setminus 1\\
&amp;\left(\sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t-1} sb_{std,p,t-1} + p^{st,ds}_{t-1} - \sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t-1} sb_{std,p,t-1}\right) &amp;\\
&amp;-\left(\sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t} sb_{std,p,t} + p^{st,ds}_{t} - \sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t} sb_{std,p,t}\right) \le z^{st, ds}_{t}  &amp; \forall t \in \mathcal{T} \setminus 1\\
&amp;\left(\sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t-1} sb_{std,p,t-1} + p^{st,ds}_{t-1} - \sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t-1} sb_{std,p,t-1}\right) &amp;\\
&amp;-\left(\sum_{p \in \mathcal{P}^{\text{as}_\text{up}}} R^*_{p,t} sb_{std,p,t} + p^{st,ds}_{t} - \sum_{p \in \mathcal{P}^{\text{as}_\text{dn}}} R^*_{p,t} sb_{std,p,t}\right) \ge -z^{st, ds}_{t}  &amp; \forall t \in \mathcal{T} \setminus 1
\end{aligned}\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorials/simulation_tutorial/">« Simulating operations with StorageSystemSimulations</a><a class="docs-footer-nextpage" href="../../code_base_developer_guide/developer/">Guidelines for Developers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Wednesday 19 March 2025 18:05">Wednesday 19 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
